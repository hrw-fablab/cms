{% extends "base.html" %}
{% load wagtailcore_tags wagtailroutablepage_tags %}
{% block content %}
    <main class="fl-main" id="main">
        <div id="calendar"></div>
    </main>
    <script>
        const calendar = document.getElementById("calendar");

    const convertCookie = () => {
        let str = document.cookie
        str = str.split('; ');
        const result = {};
        for (let i in str) {
            const cur = str[i].split('=');
            result[cur[0]] = cur[1];
        }
        return result
    }
    const getData = async () => {
        const tokens = convertCookie()
        const data = await fetch("{% url 'get_more_tables' %}", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                'X-CSRFToken': tokens.csrftoken
            },
            body: JSON.stringify({
                year: new Date().getFullYear(),
                month: new Date().getMonth() +1,
            }),
        });
        const json = await data.json();
        const events = JSON.parse(json)
        console.log(events)
    }

    window.addEventListener("load", getData)
    </script>
{% endblock content %}
